# Migration Plan: iti-ui from barebones mogwai to iti component library

**Date:** 2026-02-18

## Overview

Switch the PirateBay app UI from hand-rolled mogwai HTML to the `iti` component library,
adopting Bootstrap 5 styling throughout. The search results table stays as a table (with
Bootstrap table classes), and the detail view keeps its current layout (with Bootstrap styling).

## Decisions

- **Scope:** Full migration - replace all barebones mogwai HTML with iti components where applicable
- **Styling:** Adopt Bootstrap 5 fully - remove old styles.css, use Bootstrap classes everywhere
- **Assets:** Copy Bootstrap/FontAwesome assets from the local iti checkout into the project
- **Search results:** Keep as a `<table>` with Bootstrap table classes (preserves column sorting)
- **Detail view:** Keep current layout, apply Bootstrap styling (no Card wrapper)
- **View switching:** Use `iti::components::Panes<V>` for search/detail view switching
- **App header:** Add a Bootstrap navbar with app title
- **Dependency source:** Local path (`path = "../../../iti/crates/iti"`) for dev iteration

## Step-by-step Plan

### 1. Add iti dependency and copy assets

**Cargo.toml changes:**
- Add `iti = { path = "../../../iti/crates/iti", default-features = false }`
- The `default-features = false` disables the library/gallery feature
- iti transitively provides mogwai 0.7, so the existing mogwai dep stays compatible

**Asset setup - copy from `/Users/schell/code/iti/assets/` into `assets/`:**
- `bootstrap.min.css`
- `bootstrap-icons.min.css`
- `fonts/` directory (woff/woff2 for bootstrap-icons)
- `fontawesome/` directory (css + webfonts)
- `style.css` (iti's minimal overrides)

### 2. Update index.html

- Add viewport meta tag for responsive Bootstrap layout
- Add Trunk `data-trunk rel="css"` links for `bootstrap.min.css`, `bootstrap-icons.min.css`, `style.css`
- Add `data-trunk rel="copy-dir"` for `fontawesome/` and `fonts/`
- Add runtime `<link rel="stylesheet" href="fontawesome/css/all.min.css">`
- Replace old `styles.css` link with new app-specific stylesheet
- Update `<title>` from "Tauri + Mogwai App" to "PirateBay"

### 3. Replace styles.css with Bootstrap-compatible overrides

Remove the old styles.css content (logo hover, custom button/input styles, etc.) since Bootstrap
provides all of this. Keep a minimal styles.css for app-specific overrides only:
- Table column widths for search results
- Search result hover effect
- Sort direction indicator positioning

### 4. Migrate App container (app.rs)

**Current:** `<main class="container">` with manual `remove_child`/`append_child` for view switching

**New:**
- Add a Bootstrap navbar header with "PirateBay" title
- Use `iti::components::Panes<V, T>` for search/detail view switching
  - Two panes: SearchView and TorrentDetail
  - `panes.select(0)` for search, `panes.select(1)` for detail
- Wrap in Bootstrap `container` class

### 5. Migrate SearchView (app.rs - search form)

**Current:** Hand-rolled `<form>` with `<input>` and `<button>`, status in a `<p>` tag

**New:**
- Use Bootstrap form classes: `input-group`, `form-control`
- Replace the plain `<button>` with `iti::components::Button<V>` (gives spinner support during search)
- Use `iti::components::Alert<V>` for status text (success/error feedback)
- Layout with Bootstrap `container`, `row`, `col` classes

### 6. Migrate SearchResults (app.rs - results table)

**Current:** Hand-rolled `<table>` inside a `<fieldset>` with custom striped row CSS

**New:**
- Apply Bootstrap `table`, `table-striped`, `table-hover` classes to the table
- Column headers keep `cursor: pointer` style and existing sort Proxy logic
- Replace emoji sort indicators (ðŸ”½/ðŸ”¼) with `iti::components::Icon<V>` using Font Awesome
  glyphs (e.g., caret-down / caret-up)
- TorrentView rows get Bootstrap table row styling
- Wrap in a simple `<div>` with a heading instead of `<fieldset>`

### 7. Migrate TorrentDetail (detail.rs)

**Current:** "ðŸ”™" emoji back button, Proxy-driven status text in `<p>`, detail table in `<fieldset>`

**New:**
- Replace "ðŸ”™" emoji with `iti::components::Button<V>` + `Icon<V>` (fa-arrow-left) + "Back" text
- Apply Bootstrap table classes (`table`, `table-bordered`) to the detail info table
- Use `iti::components::Alert<V>` for the phase status text (loading/error messages)
- Style the description section with Bootstrap classes
- Style the magnet link as a Bootstrap-styled button or link

### 8. Build and verify

- Run `trunk build` to verify WASM compilation
- Run `cargo tauri dev` to verify the full app works
- Verify all iti components render correctly with Bootstrap styles
- Test search, sort, detail view, back navigation, magnet link opening

## Component Mapping

| Current UI Element         | iti Component         | Bootstrap Classes                |
|----------------------------|-----------------------|----------------------------------|
| Search button              | `Button<V>`           | `btn btn-primary`                |
| Status text (`<p>`)        | `Alert<V>`            | `alert alert-info/danger`        |
| Back button (ðŸ”™ emoji)    | `Button<V>` + `Icon<V>` | `btn btn-outline-secondary`   |
| Sort indicators (ðŸ”½ðŸ”¼)    | `Icon<V>`             | Font Awesome caret glyphs        |
| Search form                | Bootstrap form        | `input-group`, `form-control`    |
| Results table              | Keep `<table>`        | `table table-striped table-hover`|
| Detail table               | Keep `<table>`        | `table table-bordered`           |
| View switching             | `Panes<V>`            | N/A (internal)                   |
| Container                  | Keep `<main>`         | `container`                      |
| App header                 | Bootstrap navbar      | `navbar`, `navbar-dark`, `bg-dark` |

## Files to Modify

1. `Cargo.toml` - add iti dependency
2. `index.html` - add Bootstrap/FontAwesome asset links, viewport meta, update title
3. `styles.css` - replace with minimal Bootstrap-compatible overrides
4. `src/app.rs` - migrate SearchView, SearchResults, TorrentView, App (use Panes)
5. `src/app/detail.rs` - migrate TorrentDetail
6. New: `assets/` directory with copied Bootstrap/FontAwesome files

## Risks / Considerations

- **mogwai version compatibility:** Both use mogwai 0.7, so types should be compatible.
  Need to verify the exact patch version resolves correctly.
- **Panes vs manual switching:** Using `Panes<V>` for view switching simplifies code but
  changes the navigation pattern. Need to ensure state persistence (localStorage) still works.
- **Bootstrap Icons vs Font Awesome:** iti's `Icon` component uses Font Awesome. Bootstrap
  Icons CSS is also included (used by some iti internals). Both will be available.
- **Sort indicator icons:** Currently use emoji. Switching to Font Awesome icons via
  `iti::Icon` is cleaner and more consistent with the rest of the UI.
- **Spinner on search button:** The iti `Button<V>` supports `start_spinner()`/`stop_spinner()`,
  which gives nice loading feedback during search queries.
